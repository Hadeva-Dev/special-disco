<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Attention Detection Settings</title>
    <link rel="stylesheet" href="./cameraPage.css" />
  </head>
  <body>
    <div class="container">
      <!-- Header -->
      <header class="header">
        <h1>Attention Detection Settings</h1>
        <p class="subtitle">Configure drowsiness and attention monitoring</p>
      </header>

      <!-- Current Status -->
      <section class="status-section">
        <h2>Current Status</h2>
        <div class="status-card">
          <div class="status-main">
            <div class="status-label">Detection Status</div>
            <div id="detection-status" class="status-value">Active</div>
          </div>
          <div class="status-details">
            <div class="status-item">
              <span class="label">Attention State:</span>
              <span id="attention-state" class="value state-awake">AWAKE</span>
            </div>
            <div class="status-item">
              <span class="label">Last Update:</span>
              <span id="last-update" class="value">Never</span>
            </div>
          </div>
        </div>

        <!-- Live Metrics -->
        <div class="metrics-grid" id="live-metrics">
          <div class="metric-card">
            <div class="metric-label">Eye Aspect Ratio</div>
            <div id="ear-value" class="metric-value">--</div>
            <div class="metric-subtext">Normal: 0.20-0.30</div>
          </div>
          <div class="metric-card">
            <div class="metric-label">Eyes Closed Duration</div>
            <div id="closed-duration" class="metric-value">0.0s</div>
            <div class="metric-subtext">Alert at 1.5s</div>
          </div>
          <div class="metric-card">
            <div class="metric-label">Confidence</div>
            <div id="confidence" class="metric-value">--</div>
            <div class="metric-subtext">Detection accuracy</div>
          </div>
        </div>
      </section>

      <!-- Settings -->
      <section class="settings-section">
        <h2>Detection Settings</h2>

        <div class="setting-group master-toggle">
          <label class="setting-toggle">
            <input type="checkbox" id="enable-detection" checked />
            <span class="toggle-label"><strong>Enable Attention Detection</strong></span>
          </label>
          <p class="setting-description">Master switch for all drowsiness and attention monitoring</p>
        </div>

        <div class="detectors-grid">
          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-drowsiness" checked />
              <span class="toggle-label">Drowsiness (EAR)</span>
            </label>
            <p class="detector-description">Alerts after 1.5s of closed eyes</p>
          </div>

          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-microsleep" checked />
              <span class="toggle-label">Microsleep Detection</span>
            </label>
            <p class="detector-description">Alerts after 3s+ of closed eyes</p>
          </div>

          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-yawning" />
              <span class="toggle-label">Yawning Detection</span>
            </label>
            <p class="detector-description">Detects excessive yawning</p>
          </div>

          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-gaze" />
              <span class="toggle-label">Gaze Direction</span>
            </label>
            <p class="detector-description">Tracks where you're looking</p>
          </div>

          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-head-pose" />
              <span class="toggle-label">Head Pose Tracking</span>
            </label>
            <p class="detector-description">Monitors head tilt and position</p>
          </div>

          <div class="detector-card">
            <label class="setting-toggle">
              <input type="checkbox" id="detector-blink-rate" />
              <span class="toggle-label">Blink Rate Analysis</span>
            </label>
            <p class="detector-description">Tracks blinking patterns</p>
          </div>
        </div>

        <div class="setting-actions">
          <button id="save-settings" class="btn btn-primary">Save Settings</button>
        </div>

        <div class="info-box">
          <strong>Note:</strong> Detection thresholds are automatically optimized and cannot be adjusted.
        </div>
      </section>

      <!-- How It Works -->
      <section class="info-section">
        <h2>How It Works</h2>
        <div class="info-grid">
          <div class="info-card">
            <h4>What Gets Monitored</h4>
            <p>The extension monitors your attention through webcam-based facial analysis when enabled. Different detectors track eye closure, yawning, gaze direction, and more.</p>
          </div>
          <div class="info-card">
            <h4>When Alerts Trigger</h4>
            <p>If drowsiness or inattention is detected based on your enabled settings, you'll see an alert with a puzzle challenge. Your current tab stays open.</p>
          </div>
          <div class="info-card">
            <h4>Privacy</h4>
            <p>All detection happens locally on your device. No video or images are transmitted or stored anywhere.</p>
          </div>
          <div class="info-card">
            <h4>Recommended Settings</h4>
            <p>Start with just Drowsiness and Microsleep enabled. Add other detectors based on your needs to avoid false positives.</p>
          </div>
        </div>
      </section>
    </div>

    <script type="module" src="./cameraPage.ts"></script>
  </body>
</html>
